#!/usr/bin/python

import socket

rede = input("Digite a rede:\n")

for ip in range(1, 254):
    ip2 = str(ip)
    ativo = rede + '.' + ip2

    tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    tcp.settimeout(5)
    code = tcp.connect_ex((ativo, 21))
    if(code == 0):
        print("-" * 65)
        print(f"\nFTP do host {ativo} está ativo. Tentando login padrão...")
        try:
            meusocket2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            meusocket2.connect((ativo, 21))
            meusocket2.settimeout(15)

            print("Versão do FTP")
            banner = meusocket2.recv(1024)
            print(banner)

            print("\nTentando autentificação com usuário ftp...")
            meusocket2.send(b"USER ftp\r\n")
            user = meusocket2.recv(1024)
            print(user)

            print("\nTentando autentificação com senha ftp...")
            meusocket2.send(b"PASS ftp\r\n")
            pw = meusocket2.recv(1024)
            print(pw)
            meusocket2.close()
            tcp.close()
        except socket.timeout:
            print("Não foi possível estabelecer conexão com o serviço\n")
            tcp.close()
